
搞定"文章分类"区块,感谢GUNlife的帮助
##############################################


:author: Rex Zhang
:date: 2005-08-08T21:47:58+08:00
:modified: 2005-08-08T21:47:58+08:00
:status: hidden
:category: 运维
:tags: Drupal


<p>搞定"文章分类"区块,感谢<a href="http://www.gnulife.cn/" target="_blank">GNUlife</a>的帮助.代码如下:</p><blockquote><p><?php<br />if (user_access('access content')) {<br /> $result = db_query("SELECT d.tid, d.name, MAX(n.created) AS updated,COUNT(*) AS count FROM {term_data} d INNER JOIN {term_node} USING (tid) INNER JOIN {node} n USING (nid) WHERE n.status = 1 GROUP BY d.tid,d.name ORDER BY updated DESC, d.name");<br />//读取分类关键词，最新文章创建的时间，降序排列<br /> $items = array();<br /> while ($category = db_fetch_object($result)) {<br />   $items[] = l($category->name .' ('. $category->count .')','taxonomy/term/'. $category->tid);<br />   //按照以前的格式显示分类区块，包括最后一片帖子的发布时间。<br />   //.'<br/>'. t('%time ago', array('%time' => format_interval(time() - $category->updated))));<br /> }<br /> return theme('item_list', $items);<br />}<br />?></p></blockquote><p>下一步就是整理分类了...这是个头痛的问题</p>
