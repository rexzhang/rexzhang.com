
Debian下开启snmpd
############################


:author: Rex Zhang
:date: 2009-08-31T22:22:16+08:00
:modified: 2009-08-31T22:22:16+08:00
:status: hidden
:category: Linux
:tags: Debian, SNMP


<p>安装</p>
<p>#aptitude install snmpd snmp</p>
<p>修改 /etc/default/snmpd。让snmpd监听所有的网卡（默认只监听回环地址127.0.0.1，这种状况下只能本机访问snmp信息）</p>
<p># snmpd options (use syslog, close stdin/out/err).<br />#SNMPDOPTS='-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid 127.0.0.1'<br />SNMPDOPTS='-Lsd -Lf /dev/null -u snmp -I -smux -p /var/run/snmpd.pid'</p>
<p>修改 /etc/snmp/snmpd.conf。配置snmpd服务。建议参考 http://www.debianhelp.co.uk/snmp.htm</p>
<p>####<br /># First, map the community name (COMMUNITY) into a security name<br /># (local and mynetwork, depending on where the request is coming<br /># from):<br /><br />#       sec.name  source          community<br />#com2sec paranoid  default         public<br />#com2sec readonly  default         public<br />com2sec local      localhost       public<br />com2sec localnet   192.168.100.0/24 public<br />#com2sec readwrite default         private<br /><br />####<br /># Second, map the security names into group names:<br /><br />#               sec.model  sec.name<br />#group MyROSystem v1        paranoid<br />#group MyROSystem v2c       paranoid<br />#group MyROSystem usm       paranoid<br />#group MyROGroup v1         readonly<br />#group MyROGroup v2c        readonly<br />#group MyROGroup usm        readonly<br />group MyRWGroup v1         readwrite<br />group MyRWGroup v2c        readwrite<br />group MyRWGroup usm        readwrite<br />group MyROSystem v1        local<br />group MyROSystem v2c       local<br />group MyROSystem usm       local<br />group MyROGroup v1         localnet<br />group MyROGroup v2c        localnet<br />group MyROGroup usm        localnet</p>
<p>基于安全的角度建议，MyRWGroup保留原状，即不开放写权限</p>
<p>#  Make sure mountd is running<br />proc mountd</p>
<p>打开磁盘使用情况监控</p>
<p>###############################################################################<br /># disk checks<br />#<br /><br /># The agent can check the amount of available disk space, and make<br /># sure it is above a set limit.<br /><br /># disk PATH [MIN=DEFDISKMINIMUMSPACE]<br />#<br /># PATH:  mount path to the disk in question.<br /># MIN:   Disks with space below this value will have the Mib's errorFlag set.<br />#        Default value = DEFDISKMINIMUMSPACE.<br /><br /># Check the / partition and make sure it contains at least 10 megs.<br /><br />disk / 10000<br />disk /home 10000<br />disk /var 10000</p>
<p>打开CPU负载均衡监控</p>
<p>###############################################################################<br /># load average checks<br />#<br /><br /># load [1MAX=DEFMAXLOADAVE] [5MAX=DEFMAXLOADAVE] [15MAX=DEFMAXLOADAVE]<br />#<br /># 1MAX:   If the 1 minute load average is above this limit at query<br />#         time, the errorFlag will be set.<br /># 5MAX:   Similar, but for 5 min average.<br /># 15MAX:  Similar, but for 15 min average.<br /><br /># Check for loads:<br />load 12 14 14</p>
<p>重启snmpd服务</p>
<p>#/etc/init.d/snmpd restart</p>
<p>本机检查</p>
<p># snmpwalk localhost -c public -v1</p>
<p>远端检查</p>
<p># snmpwalk 192.168.100.15 -c public -v1</p>
